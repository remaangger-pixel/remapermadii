<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player</title>

<!-- SUPABASE CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,sans-serif;
}
header{
  padding:12px 16px;
  background:#111;
  display:flex;
  align-items:center;
  gap:12px;
}
header button{
  background:#e50914;
  border:none;
  color:#fff;
  padding:6px 12px;
  border-radius:6px;
  cursor:pointer;
}
.player{
  position:relative;
  width:100%;
  padding-top:56.25%;
  background:#000;
}
.player iframe{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:none;
}
.info{
  padding:16px;
}
.info h1{
  margin:0 0 8px 0;
  font-size:20px;
}
.info p{
  margin:0;
  color:#aaa;
  font-size:14px;
}
</style>
</head>
<body>

<header>
  <button onclick="history.back()">‚Üê Back</button>
  <span id="headerTitle">Loading...</span>
</header>

<div class="player" id="player"></div>

<div class="info">
  <h1 id="title"></h1>
  <p id="type"></p>
</div>

<script>
/* ================= SUPABASE INIT ================= */
const SUPABASE_URL = "https://xvktodveoxnuelhtzaog.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2a3RvZHZlb3hudWVsaHR6YW9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3NzEzMjAsImV4cCI6MjA4NTM0NzMyMH0.WUvB6oKtKxxgO-5z0SH8uBUQx9c3Gn6r170qxGeKWTI";

const sb = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

/* ================= GET ID ================= */
const params = new URLSearchParams(location.search);
const movieId = params.get("id");

if(!movieId){
  document.body.innerHTML = "<p style='padding:20px'>Video tidak ditemukan</p>";
  throw new Error("No ID");
}

/* ================= LOAD MOVIE ================= */
async function loadMovie(){
  const { data, error } = await sb
    .from("Movies")
    .select("*")
    .eq("id", movieId)
    .single();

  if(error || !data){
    document.body.innerHTML = "<p style='padding:20px'>Video tidak ditemukan</p>";
    return;
  }

  document.title = data.title;
  document.getElementById("title").innerText = data.title;
  document.getElementById("headerTitle").innerText = data.title;
  document.getElementById("type").innerText = data.type || "";

  document.getElementById("player").innerHTML = `
    <iframe 
      src="${data.video}" 
      allow="autoplay; fullscreen"
      allowfullscreen>
    </iframe>
  `;
}

loadMovie();
</script>

</body>
</html>
