<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Playing Video - Anvi Create</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root {
Â  --bg: #000000;
Â  --card: #0f0f0f;
Â  --accent: #ff0513;
Â  --text: #ffffff;
Â  --muted: #888888;
}

body {
Â  margin: 0; background: var(--bg); color: var(--text);
Â  font-family: 'Inter', sans-serif; overflow-x: hidden;
}

header {
Â  padding: 15px 5%; background: rgba(0,0,0,0.8);
Â  display: flex; align-items: center; gap: 15px;
Â  border-bottom: 1px solid #111;
}

.back-btn {
Â  background: #222; border: none; color: #fff;
Â  padding: 8px 15px; border-radius: 8px; cursor: pointer;
Â  font-weight: bold; transition: 0.3s;
}
.back-btn:hover { background: var(--accent); }

/* VIDEO CONTAINER */
.player-wrapper {
Â  width: 100%; max-width: 1100px; margin: 20px auto;
Â  padding: 0 15px; box-sizing: border-box;
}

.video-container {
Â  position: relative; width: 100%; padding-top: 56.25%; /* 16:9 Aspect Ratio */
Â  background: #080808; border-radius: 12px; overflow: hidden;
Â  box-shadow: 0 20px 50px rgba(0,0,0,0.8);
}

.video-container iframe {
Â  position: absolute; inset: 0; width: 100%; height: 100%; border: none;
}

/* INFO SECTION */
.video-info {
Â  margin-top: 25px; padding: 0 5%;
}

.video-info h1 {
Â  font-size: 26px; margin: 0 0 10px; font-weight: 800;
}

.meta-data {
Â  display: flex; align-items: center; gap: 15px; margin-bottom: 20px;
}

.tag {
Â  background: #1a1a1a; padding: 5px 12px; border-radius: 6px;
Â  font-size: 12px; color: var(--muted); border: 1px solid #222;
}

.desc {
Â  line-height: 1.6; color: #ccc; font-size: 15px; max-width: 800px;
}

/* ACTION BUTTONS */
.actions {
Â  display: flex; gap: 10px; margin-top: 20px;
}

.action-btn {
Â  background: #111; border: 1px solid #222; color: #fff;
Â  padding: 10px 20px; border-radius: 50px; cursor: pointer;
Â  font-size: 13px; transition: 0.3s;
}
.action-btn:hover { border-color: var(--accent); color: var(--accent); }

/* SKELETON LOADING */
.loader {
Â  position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
Â  background: #000; z-index: 5; transition: 0.5s;
}
.spinner {
Â  width: 40px; height: 40px; border: 4px solid #333;
Â  border-top-color: var(--accent); border-radius: 50%;
Â  animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

@media(max-width: 768px) {
Â  .video-info h1 { font-size: 20px; }
Â  .player-wrapper { padding: 0; }
Â  .video-container { border-radius: 0; }
}
</style>
</head>
<body>

<header>
Â  <button class="back-btn" onclick="history.back()">â† Kembali</button>
Â  <span id="navTitle" style="color:var(--muted); font-size:14px">Memuat...</span>
</header>

<div class="player-wrapper">
Â  <div class="video-container">
Â  Â  <div id="loader" class="loader"><div class="spinner"></div></div>
Â  Â  <div id="playerFrame"></div>
Â  </div>
</div>

<div class="video-info">
Â  <div class="meta-data">
Â  Â  <span class="tag" id="videoType">Video</span>
Â  Â  <span class="tag">HD 1080p</span>
Â  Â  <span class="tag" id="videoYear">2026</span>
Â  </div>
Â  <h1 id="title">Judul Video</h1>
Â  <p class="desc" id="description">Sedang memuat informasi video...</p>

Â  <div class="actions">
Â  Â  <button class="action-btn" onclick="location.reload()">ğŸ”„ Refresh Player</button>
Â  Â  <button class="action-btn" onclick="alert('Terima kasih! Laporan dikirim ke admin.')">ğŸš© Lapor Error</button>
Â  Â  <button class="action-btn" onclick="shareVideo()">ğŸ”— Bagikan</button>
Â  </div>
</div>

<script>
const SUPABASE_URL = "https://xvktodveoxnuelhtzaog.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2a3RvZHZlb3hudWVsaHR6YW9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3NzEzMjAsImV4cCI6MjA4NTM0NzMyMH0.WUvB6oKtKxxgO-5z0SH8uBUQx9c3Gn6r170qxGeKWTI";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const params = new URLSearchParams(location.search);
const movieId = params.get("id");
const episodeId = params.get("episode");

async function loadContent() {
Â  if (movieId) {
Â  Â  const { data, error } = await sb.from("Movies").select("*").eq("id", movieId).single();
Â  Â  if (!error && data) render(data.title, data.video, "Movie");
Â  } else if (episodeId) {
Â  Â  const { data, error } = await sb.from("Episodes").select("*, Series(title)").eq("id", episodeId).single();
Â  Â  if (!error && data) render(`${data.Series.title} - Eps ${data.episode}`, data.video, "Series");
Â  } else {
Â  Â  document.body.innerHTML = "<h2 style='text-align:center; margin-top:50px;'>Video Tidak Ditemukan</h2>";
Â  }
}

function render(title, url, type) {
Â  document.title = title + " - Anvi Create";
Â  document.getElementById("navTitle").innerText = title;
Â  document.getElementById("title").innerText = title;
Â  document.getElementById("videoType").innerText = type;
Â  document.getElementById("description").innerText = `Kamu sedang menonton ${title}. Jika video macet atau tidak muncul, silakan klik tombol Refresh Player atau lapor ke admin kami.`;

Â  const frame = document.getElementById("playerFrame");
Â  frame.innerHTML = `<iframe src="${url}" allowfullscreen allow="autoplay; fullscreen"></iframe>`;

Â  // Hilangkan loader setelah iframe mulai dimuat
Â  setTimeout(() => {
Â  Â  document.getElementById("loader").style.opacity = "0";
Â  Â  setTimeout(() => document.getElementById("loader").remove(), 500);
Â  }, 1500);
}

function shareVideo() {
Â  navigator.clipboard.writeText(window.location.href);
Â  alert("Link video berhasil disalin ke clipboard!");
}

loadContent();
</script>

</body>
</html>
